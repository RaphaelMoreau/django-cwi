{% extends 'www/base_loggedin.html' %}

{% block title %}Application {{ application.name }} <a href='{% url 'applicationUpdate' application.id %}'>Edit</a>{% endblock %}
{% block content %}
  <img class='icon' src='{{ application.icon.url }}'/>
  Name: {{ application.name }}<br/>
  Crypto Key: {{ application.cryptoKey }}<br/>
  <br/>
  <h3>Countries
    {% if application.applicationcountry_set.count < countries_count %}
      <a href="javascript:popup('{% url 'applicationAddCountry' application.id %}')">Add</a>
    {% endif %}
  </h3>
  <ul>
  {% for country in application.applicationcountry_set.all %}
    <li>{{ country.country.name }} <a href="javascript:popup('{% url 'applicationDelCountry' application.id country.country.codeA2 %}')">Remove</a></li>
    <h4>Platforms
      {% if country.applicationplatform_set.count < platforms_count %}
        <a href="javascript:popup('{% url 'applicationAddPlatform' application.id country.id %}')">Add</a>
      {% endif %}
    </h4>
    <ul>
    {% for platform in country.applicationplatform_set.all %}
      <li>{{ platform.platform.name }} <a href="javascript:popup('{% url 'applicationDelPlatform' application.id platform.id %}')">Remove</a></li>
      <h5>Ad types
        {% if platform.applicationadtype_set.count < ads_count %}
          <a href="javascript:popup('{% url 'applicationAddAdType' application.id platform.id %}')">Add</a>
        {% endif %}
      </h4>
      <ul>
      {% for adtype in platform.applicationadtype_set.all %}
        <li>{{ adtype.adType }} <a href="javascript:popup('{% url 'applicationDelAdType' application.id adtype.id %}')">Remove</a></li>
      {% empty %}
        No ad types defined
      {% endfor %}
      </ul>
    {% empty %}
      No platform defined
    {% endfor %}
    </ul>
  {% empty %}
    No country found<br/>
  {% endfor %}
  </ul>
  <br/>
  <a href='{% url 'applicationList' %}'>Back to application list</a>
{% endblock %}
